{% extends "base.html" %}
{% block content %}
<h2>ЁЯУД Final Report / рдЕрдВрддрд┐рдо рд░рд┐рдкреЛрд░реНрдЯ:</h2>

<!-- Symptoms -->
<p><strong>Symptoms / рд▓рдХреНрд╖рдг:</strong> {{ symptoms }}</p>
{% if age %}
<p><strong>Age / рдЖрдпреБ:</strong> {{ age }} years old / {{ age }} рд╡рд░реНрд╖</p>
{% endif %}
{% if gender %}
<p><strong>Gender / рд▓рд┐рдВрдЧ:</strong> {{ gender }}</p>
{% endif %}
{% if location %}
<p><strong>Location / рд╕реНрдерд╛рди:</strong> {{ location }}</p>
{% endif %}
{% if duration %}
<p><strong>Duration of Symptoms / рд▓рдХреНрд╖рдгреЛрдВ рдХреА рдЕрд╡рдзрд┐:</strong> {{ duration }}</p>
{% endif %}
{% if medications %}
<p><strong>Medications Taken / рд▓реА рдЧрдИ рджрд╡рд╛рдПрдВ:</strong> {{ medications }}</p>
{% endif %}

<!-- Possible Cause -->
{% if possible_cause_en and possible_cause_en != "No possible causes determined." %}
<p><strong>Possible Cause / рд╕рдВрднрд╛рд╡рд┐рдд рдХрд╛рд░рдг (English):</strong></p>
<ul>
    <li>{{ possible_cause_en }}</li>
</ul>
<p><strong>рд╕рдВрднрд╛рд╡рд┐рдд рдХрд╛рд░рдг (Hindi):</strong></p>
<ul>
    <li>{{ possible_cause_hi }}</li>
</ul>

<!-- Audio Playback Buttons -->
{% if possible_cause_audio_url_hi %}
    <button onclick="playAudio('possibleCauseAudioHi')">ЁЯФК Play Possible Cause (Hindi)</button>
    <audio id="possibleCauseAudioHi" src="{{ possible_cause_audio_url_hi }}" style="display: none;"></audio>
{% endif %}
{% if possible_cause_audio_url_en %}
    <button onclick="playAudio('possibleCauseAudioEn')">ЁЯФК Play Possible Cause (English)</button>
    <audio id="possibleCauseAudioEn" src="{{ possible_cause_audio_url_en }}" style="display: none;"></audio>
{% endif %}

{% else %}
<p><strong>Possible Cause / рд╕рдВрднрд╛рд╡рд┐рдд рдХрд╛рд░рдг:</strong> No possible causes determined. / рдХреЛрдИ рд╕рдВрднрд╛рд╡рд┐рдд рдХрд╛рд░рдг рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ред</p>
{% endif %}

<!-- Probable Diseases -->
{% if probable_diseases %}
<h3>ЁЯй║ Probable Diseases / рд╕рдВрднрд╛рд╡рд┐рдд рд░реЛрдЧ:</h3>
<ul>
    {% for disease, prob in probable_diseases.items() %}
    <li><strong>{{ disease }}:</strong> {{ prob }}%</li>
    {% endfor %}
</ul>
{% else %}
<p>No probable diseases found based on the entered symptoms and information. / рдЖрдкрдХреЗ рджрд░реНрдЬ рдХрд┐рдП рдЧрдП рд▓рдХреНрд╖рдгреЛрдВ рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХреЛрдИ рд╕рдВрднрд╛рд╡рд┐рдд рд░реЛрдЧ рдирд╣реАрдВ рдорд┐рд▓рд╛ред</p>
{% endif %}

<!-- Transcript of Questions and Answers -->
<h3>ЁЯУЭ Transcript of Questions and Answers / рдкреНрд░рд╢реНрдиреЛрдВ рдФрд░ рдЙрддреНрддрд░реЛрдВ рдХрд╛ рдЯреНрд░рд╛рдВрд╕рдХреНрд░рд┐рдкреНрдЯ:</h3>
<ul>
    <!-- Initial Symptom Input -->
    {% for entry in conversation_history %}
        {% if entry['user_input'] %}
            <li><strong>Initial Symptom Input / рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд▓рдХреНрд╖рдг рдЗрдирдкреБрдЯ:</strong> {{ entry['user_input'] }}</li>
        {% endif %}
    {% endfor %}
    <hr>
    <!-- Follow-Up Q&A -->
    {% set question_count = 1 %}
    {% for entry in conversation_history %}
        {% if entry['followup_question_en'] and entry['response'] %}
            <li>
                <p><strong>Question {{ question_count }} (English) / рдкреНрд░рд╢реНрди {{ question_count }} (рдЕрдВрдЧреНрд░реЗрдЬреА):</strong> {{ entry['followup_question_en'] }}</p>
                <p><strong>Your Answer / рдЖрдкрдХрд╛ рдЙрддреНрддрд░:</strong> {{ entry['response'] }}</p>
            </li>
            <hr>
            {% set question_count = question_count + 1 %}
        {% endif %}
    {% endfor %}
</ul>

<!-- JavaScript for Audio Playback -->
{% if possible_cause_audio_url_hi or possible_cause_audio_url_en %}
<script>
function playAudio(audioId) {
    var audio = document.getElementById(audioId);
    audio.play();
}
</script>
{% endif %}

{% endblock %}
